/**
 * @license 
 * Copyright (c) 2015, Immo Schulz-Gerlach, www.isg-software.de 
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification, are 
 * permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this list of
 * conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice, this list
 * of conditions and the following disclaimer in the documentation and/or other materials
 * provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY 
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT 
 * SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, 
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED 
 * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
 * OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN 
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY
 * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
!function($){"use strict";$.fn.progressPie=function(e){function t(e){return.02*Math.PI*e}function n(e,t){var n=eval,r=n(e);if("function"==typeof r)return r(t);throw"The value of the attribute "+s.colorFunctionAttr+" is NOT a function: "+e}function r(e){var t=eval,n=t("$.fn.progressPie.svgContentPlugin."+e);if("function"==typeof n)return n;throw e+" is not the name of a function in namespace $.fn.progressPie.svgContentPlugin!"}function o(e,n,r,o,i,a,u,s,f){"number"==typeof r&&(r=Math.min(r,n)),"number"==typeof i&&(i=Math.min(i,n));var d=document.createElementNS(l,"circle");d.setAttribute("cx",0),d.setAttribute("cy",0);var p=i&&100===u?i:r;if(d.setAttribute("r",n-p/2),d.style.stroke="string"==typeof o&&100>u?o:s,d.style.strokeWidth=p,d.style.fill=i||100!==u?"none":s,e.appendChild(d),u>0&&100>u){var c=document.createElementNS(l,"path"),v=t(u),g=Math.sin(v)*n,h=Math.cos(v-Math.PI)*n,y=u>50?"1":"0",A="1",m=i?n-i:0,b=-m,C="M0,"+b,R;if(i&&a?(R=i/2,C+="a"+R+","+R+" 0 0,"+A+" 0,-"+i):C+=" v-"+(i?i:n),C+=" A"+n+","+n+" 0 "+y+","+A+" "+g+","+h,i){var E=Math.sin(v)*m,P=Math.cos(v-Math.PI)*m,M="0";C+=a?" A"+R+","+R+" 0 0,"+A+" "+E+","+P:" L"+E+","+P,C+=" A"+m+","+m+" 0 "+y+","+M+" 0,-"+m}else C+=" Z";if(c.setAttribute("d",C),c.style.fill=s,c.style.stroke="none",f){var S=f.clockwise===!1,O="string"==typeof f?f:"string"==typeof f.duration?f.duration:"1s",N=document.createElementNS(l,"animateTransform");N.setAttribute("attributeName","transform"),N.setAttribute("attributeType","XML"),N.setAttribute("type","rotate"),N.setAttribute("from","0"),N.setAttribute("to",S?"-360":"360"),N.setAttribute("dur",O),N.setAttribute("repeatDur","indefinite"),c.appendChild(N)}e.appendChild(c)}}function i(e,t){var n;if("string"==typeof t.valueData){if(n=e.data(t.valueData),"undefined"!=typeof t.valueAttr||"undefined"!=typeof t.valueSelector)throw"options 'valueData', 'valueAttr' and 'valueSelector' are mutually exclusive, i.e. at least two must be undefined!"}else{if("undefined"!=typeof t.valueData)throw"option 'valueData' is not of type 'string'!";if("string"==typeof t.valueAttr){if(n=e.attr(t.valueAttr),"undefined"!=typeof t.valueSelector)throw"options 'valueAttr' and 'valueSelector' are mutually exclusive, i.e. at least one must be undefined!"}else{if("undefined"!=typeof t.valueAttr)throw"option 'valueAttr' is not of type 'string'!";"undefined"!=typeof t.valueSelector&&(n=$(t.valueSelector,e).text())}}return"undefined"==typeof n&&(n=e.text()),Math.max(0,Math.min(100,t.valueAdapter(n)))}function a(e,t){var n=t.mode,r=t.color,o=typeof r;if("undefined"!==o&&"string"!==o&&"function"!==o)throw"option 'color' has to be either a function or a string, but is of type '"+o+"'!";return"function"===o?n=d.USER_COLOR_FUNC:("undefined"===o&&"string"==typeof t.colorAttr&&(r=e.attr(t.colorAttr)),"string"==typeof r?n=d.USER_COLOR_CONST:"string"==typeof t.colorFunctionAttr&&(r=e.attr(t.colorFunctionAttr),"string"==typeof r&&(n=d.DATA_ATTR_FUNC))),{mode:n,color:r}}function u(e,t,r){return e===d.GREY?d.GREY.color:e===d.GREEN?f.colorByPercent(100):e===d.RED?f.colorByPercent(0):e===d.COLOR||void 0===t?f.colorByPercent(r):e===d.USER_COLOR_CONST?t:e===d.USER_COLOR_FUNC?t(r):e===d.DATA_ATTR_FUNC?n(t,r):"black"}var s=$.extend({},$.fn.progressPie.defaults,e),l="http://www.w3.org/2000/svg",f=$.fn.progressPie,d=$.extend({USER_COLOR_CONST:{},USER_COLOR_FUNC:{},DATA_ATTR_FUNC:{}},f.Mode);return $(this).each(function(){var e=$(this),t=$("svg",e);if(!t.length||s.update){t.length&&s.update&&(t.remove(),s.separator="");var n=i(e,s),f=a(e,s),d=Math.ceil("number"==typeof s.size?s.size:e.height());0===d&&(d=20);var p=Math.floor(d/2),c=p,v=document.createElementNS(l,"svg");v.setAttribute("width",d),v.setAttribute("height",d),v.setAttribute("viewBox","-"+c+" -"+c+" "+d+" "+d),v.style.verticalAlign=s.verticalAlign,s.prepend?e.prepend(v,s.separator):e.append(s.separator,v);var g=u(f.mode,f.color,n);o(v,c,s.strokeWidth,s.strokeColor,s.ringWidth,s.ringEndsRounded,n,g,s.rotation);var h="number"==typeof s.ringWidth?s.ringWidth:"number"==typeof s.strokeWidth?s.strokeWidth:0;if("object"==typeof s.inner&&("undefined"==typeof s.inner.valueAdapter&&(s.inner.valueAdapter=$.fn.progressPie.defaults.valueAdapter),n=i(e,s.inner),f=a(e,s.inner),c=Math.floor("number"==typeof s.inner.size?s.inner.size/2:.6*c),g=u(f.mode,f.color,n),o(v,c,0,void 0,s.inner.ringWidth,s.inner.ringEndsRounded,n,f.mode,f.color),h="number"==typeof s.inner.ringWidth?s.inner.ringWidth:0),s.svgContentPlugin){var y;"function"==typeof s.svgContentPlugin?y=s.svgContentPlugin:"string"==typeof s.svgContentPlugin&&(y=r(s.svgContentPlugin));var A=c;c>h&&(A-=h),y({newSvgElement:function(e){var t=document.createElementNS(l,e);return v.appendChild(t),t},radius:A,color:g})}}}),this},$.fn.progressPie.Mode={GREY:{color:"#888"},RED:{value:200},GREEN:{value:200},COLOR:{}},$.fn.progressPie.colorByPercent=function(e){var t=$.fn.progressPie.Mode.GREEN.value,n=$.fn.progressPie.Mode.RED.value,r=e>50?t:Math.floor(t*e/50),o=50>e?n:Math.floor(n*(100-e)/50);return"rgb("+o+","+r+",0)"},$.fn.progressPie.defaults={mode:$.fn.progressPie.Mode.GREY,strokeWidth:2,prepend:!0,separator:"&nbsp;",verticalAlign:"bottom",update:!1,valueAdapter:function(e){return"string"==typeof e?parseInt(e):"number"==typeof e?e:0},ringEndsRounded:!1},$.fn.progressPie.svgContentPlugin={}}(jQuery);